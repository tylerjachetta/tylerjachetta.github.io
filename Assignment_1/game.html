<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
    <title>Cards and Conditionals</title>
    
    <!-- step 1: load jQuery library -->
	<script src="jquery-1.12.0.min.js"></script>
    
    <!-- step 2: load playing cards project files (js + css) -->
	<script src="playingCards.js"></script>
	<script src="playingCards.ui.js"></script>
    <link rel="stylesheet" type="text/css" href="playingCards.ui.css">
</head>
<body style = "background-color: #006400; font-family: Arial; color: white;">
	
	<!-- step 3: provide html elements for UI -->
	<div id="controls">
		<h1 id="header"></h1>
		<button type="button" onclick="startRound();" id="startButton">
			Start!
		</button>
		<button type="button" onclick="hit();" id="hitButton" style="visibility:hidden;">
			Hit
		</button>
		<button type="button" onclick="stay();" id="stayButton" style="visibility:hidden;">
			Stay
		</button>
		<button type="button" onclick="window.location.reload();" id="restartButton" style="visibility:hidden;">
			Play again
		</button>
	</div>
	
	<h4 id="scoreboard">
	</h4>
	
	<div id="cardtray">
	</div>

	<div id="cardtray2" style="margin-left: 300px; margin-top:150px;">
	</div>
	<h4 id="scoreboard2">
	</h4>
	

	<script>
		// set score
		var score = 0, score2 = 0;
		
		// create card deck object
     	   	var cardDeck = $("#cardtray").playingCards();
        
        // shuffle card objects
      		cardDeck.shuffle();

		function startRound() 
		{
			document.getElementById('startButton').style.display = 'none'; 
			document.getElementById('hitButton').style.visibility = 'visible'; 
			document.getElementById('stayButton').style.visibility = 'visible'; 

			addCardPlayerDeck();
			addCardPlayerDeck();
			addCardDealerDeck();
			addCardDealerDeck();
		}
		
		function addCardPlayerDeck()
		{
			var newCard = cardDeck.draw();
			getCardValue (newCard);
			$('#scoreboard').html( score );
			markup = newCard.getHTML();
			$('#cardtray').append( markup );
		}
		function addCardDealerDeck()
		{
			var newCard = cardDeck.draw();
			getCardValueD (newCard);
			$('#scoreboard2').html( score2 );
			markup = newCard.getHTML();
			$('#cardtray2').append( markup );
		}
		function getCardValue (card)
		{
			if ( ( card.rank == 'Q' ) || (card.rank == 'K') || (card.rank == 'J'))
			{
				score += 10; // score++;
				
			} 
			else if ( card.rank == 'A' )
			{

				if(score+11 > 21)
				{
					score++;
				}
				else 
				{
					score += 11;
				}
			}
			else
			{
				score += Number(card.rank); // score--;
			}

			if(score > 21)
			{
				loss();

			}
			
		}

		function getCardValueD (card)
		{
			if ( ( card.rank == 'Q' ) || (card.rank == 'K') || (card.rank == 'J'))
			{
				score2 += 10; // score++;
				
			} 
			else if ( card.rank == 'A' )
			{
				if(score2+11 > 21)
				{
					score2++;
				}
				else 
				{
					score2 += 11;
				}
			}
			else
			{
				score2 += Number(card.rank); // score--;
			}

			if(score2 > 21)
			{
				win();
			}
		}
		function hit ()
		{
			addCardPlayerDeck();

			hitD();
		}

		function hitD ()
		{
			var chance = Math.floor((Math.random() * 10) + 1);
			
			if(score2 <= 10)
			{
				addCardDealerDeck();
			}
			else if (score2 < 17)
			{
				var chance = Math.floor((Math.random() * 10) + 1);
				console.log(chance);

				if(chance < 7)
				{
					addCardDealerDeck();
				}
			}
		
		}
		
		function restart()
		{
			document.getElementById('stayButton').style.display = 'none'; 
			document.getElementById('hitButton').style.display = 'none'; 
			document.getElementById('restartButton').style.visibility = 'visible'; 
		}

		function stay()
		{	
			if (score2 > 21 && score < 22)
			{
				win();
			} 
			else if(score > score2 && score < 22)
			{
				hitD();
				win();
				stay();
			}
			else
			{
				loss();
			}
		}

		function loss()
		{
			$('#header').html("You lose!" );
			restart();
		}

		function win()
		{

			$('#header').html("You Won!" );
			restart();
		}
    </script>
  </div>
</body>
</html>
